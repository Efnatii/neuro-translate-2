<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <title>Neuro Translate</title>
    <link rel="stylesheet" href="./popup.css">
  </head>
  <body>
    <main class="popup">
      <header class="popup__header">
        <div class="popup__brand">
          <h1 class="popup__title">Neuro Translate</h1>
          <p class="popup__subtitle">ИИ-агент перевода страницы</p>
        </div>
        <div class="popup__header-actions">
          <button
            class="popup__debug"
            type="button"
            data-action="open-debug"
            title="Открыть расширенную страницу отладки"
          >
            Отладка ↗
          </button>
          <button
            class="popup__debug popup__debug--secondary"
            type="button"
            data-action="open-export"
            title="Открыть раздел экспорта отчёта в debug"
          >
            Экспорт отчёта ↗
          </button>
        </div>
      </header>

      <section class="popup__top-strip" aria-label="Статус и быстрые действия">
        <div class="popup__status-card">
          <div class="popup__status-header">
            <span class="popup__label popup__label--strong">Статус текущей вкладки</span>
            <span class="popup__status-text" data-field="status-text">—</span>
          </div>
          <div class="popup__agent-status" data-field="agent-status">Агент: —</div>
          <div class="popup__status-chips" data-section="status-chips">
            <span class="popup__status-chip" data-field="status-chip-pipeline" title="Текущее состояние пайплайна перевода">
              Пайплайн: —
            </span>
            <span class="popup__status-chip" data-field="status-chip-model" title="Эффективная политика выбора модели">
              Модели: —
            </span>
            <span class="popup__status-chip" data-field="status-chip-cache" title="Состояние кэша страниц и API">
              Кэш: —
            </span>
          </div>
          <label class="popup__label popup__label--muted" for="status-progress">Прогресс шага</label>
          <progress id="status-progress" class="popup__progress" value="0" max="100" data-field="status-progress"></progress>
          <div class="popup__multi-jobs">
            <span class="popup__label popup__label--muted" data-field="active-jobs-summary">Активные задачи: 0</span>
            <select class="popup__select popup__select--mode" data-field="active-jobs-select" aria-label="Активные задачи"></select>
            <button class="popup__debug popup__debug--secondary" type="button" data-action="goto-job-tab" title="Перейти к вкладке выбранной задачи">
              Перейти
            </button>
          </div>
        </div>

        <div class="popup__action-grid">
          <button class="popup__icon-button popup__action-button" type="button" data-action="start-translation" title="Запустить перевод" aria-label="Запустить перевод">
            <svg class="popup__icon" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M7 5L19 12L7 19Z"></path>
            </svg>
            <span class="popup__action-label">Перевести</span>
          </button>
          <button class="popup__icon-button popup__action-button" type="button" data-action="cancel-translation" title="Остановить текущий процесс перевода" aria-label="Остановить перевод">
            <svg class="popup__icon" viewBox="0 0 24 24" aria-hidden="true">
              <rect x="7" y="7" width="10" height="10"></rect>
            </svg>
            <span class="popup__action-label">Отменить</span>
          </button>
          <button class="popup__icon-button popup__action-button" type="button" data-action="clear-translation-data" title="Отменить перевод и стереть данные страницы" aria-label="Отменить и стереть">
            <svg class="popup__icon" viewBox="0 0 24 24" aria-hidden="true">
              <rect x="6" y="6" width="12" height="12"></rect>
              <path d="M4 7H20"></path>
              <path d="M9 7V5H15V7"></path>
              <path d="M7 7L8 20H16L17 7"></path>
            </svg>
            <span class="popup__action-label">Стереть</span>
          </button>
          <div class="popup__action-mode popup__action-button--wide" title="Сравнение подсвечивает изменения. Для больших блоков см. debug.">
            <label class="popup__action-mode-label" for="display-mode-select">Режим отображения</label>
            <select id="display-mode-select" class="popup__select popup__select--mode" data-field="display-mode-select" aria-label="Режим отображения">
              <option value="translated">Перевод</option>
              <option value="original">Оригинал</option>
              <option value="compare">Сравнение (diff)</option>
            </select>
          </div>
        </div>
      </section>

      <nav class="popup__tabs" role="tablist" aria-label="Разделы">
        <button
          class="popup__tab is-active"
          type="button"
          role="tab"
          id="popup-tab-button-control"
          data-action="switch-tab"
          data-tab="control"
          aria-controls="popup-tab-control"
          aria-selected="true"
          tabindex="0"
          title="Запуск перевода, категории и расширенный runtime-статус"
        >
          Управление
        </button>
        <button
          class="popup__tab"
          type="button"
          role="tab"
          id="popup-tab-button-agent"
          data-action="switch-tab"
          data-tab="agent"
          aria-controls="popup-tab-agent"
          aria-selected="false"
          tabindex="-1"
          title="Профиль, модельная политика и настройки размышления агента"
        >
          Агент
        </button>
        <button
          class="popup__tab"
          type="button"
          role="tab"
          id="popup-tab-button-models"
          data-action="switch-tab"
          data-tab="models"
          aria-controls="popup-tab-models"
          aria-selected="false"
          tabindex="-1"
          title="API-ключ, разрешённые модели, инструменты и кэш"
        >
          Модели и кэш
        </button>
      </nav>

      <section class="popup__tab-panels">
        <section
          class="popup__tab-panel is-active"
          role="tabpanel"
          id="popup-tab-control"
          data-tab-panel="control"
          aria-labelledby="popup-tab-button-control"
        >
          <div class="popup__context-note" title="Категории предлагаются после первичного планирующего анализа агента">
            Выбор категорий появляется после первичного анализа агента.
          </div>

          <div class="popup__runtime-categories" data-section="category-chooser" hidden>
            <div class="popup__label popup__runtime-categories-hint" data-field="category-chooser-hint">—</div>
            <div class="popup__categories popup__categories--runtime" data-section="category-chooser-list"></div>
          </div>

          <details class="popup__details popup__details--runtime-status" data-section="runtime-status-extended" open>
            <summary title="Подробные live-метрики выполнения переводчика-агента">Расширенный статус</summary>
            <div class="popup__status-metrics" data-section="status-metrics"></div>
            <div class="popup__status-trace" data-field="status-trace">—</div>
          </details>
        </section>

        <section
          class="popup__tab-panel"
          role="tabpanel"
          id="popup-tab-agent"
          data-tab-panel="agent"
          aria-labelledby="popup-tab-button-agent"
          hidden
        >
          <div class="popup__mini-statuses" data-section="agent-mini-statuses"></div>

          <details class="popup__details" data-section="agent-model-policy" open>
            <summary title="Эти параметры задают базовый приоритет выбора модели для переводчика-агента">
              Профиль и политика выбора моделей
            </summary>

            <div class="popup__field-group">
              <label class="popup__label" for="agent-profile">Профиль агента</label>
              <select id="agent-profile" class="popup__select" data-field="agent-profile" title="Профиль влияет на стиль, батчинг и стратегию перевода">
                <option value="auto">Авто (адаптивный)</option>
                <option value="fast">Быстрый</option>
                <option value="balanced">Сбалансированный</option>
                <option value="bulk">Массовый</option>
                <option value="accurate">Точный</option>
                <option value="research">Исследовательский</option>
                <option value="custom">Custom</option>
              </select>
            </div>

            <div class="popup__tool-grid popup__tool-grid--compact">
              <div class="popup__tool-row">
                <label for="model-routing-mode" title="Auto: агент выбирает сам; user_priority: предпочитает user priority; profile_priority: предпочитает профильный список">
                  Роутинг моделей
                </label>
                <select id="model-routing-mode" data-field="model-routing-mode" title="Режим маршрутизации выбора модели">
                  <option value="auto">AUTO</option>
                  <option value="user_priority">USER PRIORITY</option>
                  <option value="profile_priority">PROFILE PRIORITY</option>
                </select>
              </div>
              <div class="popup__tool-row">
                <label for="agent-model-policy-mode" title="Авто: агент может усиливать/ускорять выбор модели по контексту; Фиксировано: используйте заданные параметры как базу">
                  Режим приоритета
                </label>
                <select id="agent-model-policy-mode" data-field="agent-model-policy-mode" title="Режим применения политики выбора модели">
                  <option value="auto">АВТО</option>
                  <option value="fixed">ФИКСИРОВАНО</option>
                </select>
              </div>
              <label class="popup__label popup__checkbox-row" title="Если включено, приоритетно выбираются более быстрые модели в рамках доступного списка">
                <input type="checkbox" data-field="agent-model-speed">
                <span>Приоритет скорости</span>
              </label>
              <div class="popup__tool-row">
                <label for="agent-model-preference" title="Дополнительный приоритет к качеству или стоимости модели">
                  Доп. приоритет
                </label>
                <select id="agent-model-preference" data-field="agent-model-preference" title="Базовый предпочтительный уклон выбора модели">
                  <option value="none">Без приоритета</option>
                  <option value="smartest">Наиболее умные</option>
                  <option value="cheapest">Наиболее дешёвые</option>
                </select>
              </div>
              <label class="popup__label popup__checkbox-row" title="Разрешает агенту временно форсировать fast/strong маршрут для отдельных батчей">
                <input type="checkbox" data-field="agent-model-route-override">
                <span>Разрешить маршрутизацию батчей</span>
              </label>
            </div>
          </details>

          <details class="popup__details" data-section="agent-profile-preview" open>
            <summary title="Показывает итоговые параметры после применения профиля и ваших оверрайдов">
              Влияние профиля и оверрайдов
            </summary>
            <div class="popup__impact" data-section="agent-profile-impact"></div>
          </details>

          <details class="popup__details" data-section="agent-autotune" open>
            <summary title="Job-scoped авто-настройка reasoning/cache/models/tools через инструменты агента">
              Авто-настройка
            </summary>
            <div class="popup__tool-grid popup__tool-grid--compact">
              <label class="popup__label popup__checkbox-row" title="Разрешить агенту предлагать и применять job-scoped run settings">
                <input type="checkbox" data-field="autotune-enabled">
                <span>Авто-настройка агентом</span>
              </label>
              <div class="popup__tool-row">
                <label for="autotune-mode" title="auto_apply: применять автоматически; ask_user: ждать подтверждения">
                  Режим применения
                </label>
                <select id="autotune-mode" data-field="autotune-mode">
                  <option value="auto_apply">Применять автоматически</option>
                  <option value="ask_user">Спрашивать перед применением</option>
                </select>
              </div>
              <div class="popup__tool-row">
                <label>Последнее решение</label>
                <div class="popup__label popup__label--muted" data-field="autotune-last-decision">—</div>
              </div>
              <div class="popup__tool-row">
                <label>Pending diff</label>
                <div class="popup__label popup__label--muted" data-field="autotune-pending-diff">—</div>
              </div>
              <div class="popup__tool-row">
                <label>Причина</label>
                <div class="popup__label popup__label--muted" data-field="autotune-pending-reason">—</div>
              </div>
              <div class="popup__tool-grid popup__tool-grid--compact">
                <button class="popup__button" type="button" data-action="autotune-apply">Принять</button>
                <button class="popup__button" type="button" data-action="autotune-reject">Отклонить</button>
                <button class="popup__button" type="button" data-action="autotune-reset">Откатить</button>
              </div>
            </div>
          </details>

          <details class="popup__details" data-section="agent-expert-settings">
            <summary title="Расширенная настройка планирования, аудита и автосжатия контекста">
              Экспертные настройки
            </summary>

            <details class="popup__details popup__details--nested" data-section="agent-runtime-settings" open>
              <summary title="Базовые переключатели запуска пайплайна">Режим запуска</summary>
              <label class="popup__label popup__checkbox-row" title="Глобальный переключатель пайплайна перевода. При выключении запуск блокируется">
                <input type="checkbox" data-field="pipeline-enabled">
                <span>Пайплайн перевода включён</span>
              </label>
            </details>

            <details class="popup__details popup__details--nested" data-section="agent-thinking" open>
              <summary title="Тонкая настройка планирования и батчинга">Размышление и планирование</summary>
              <div class="popup__tool-grid popup__tool-grid--compact">
                <div class="popup__tool-row">
                  <label for="reasoning-mode" title="Auto: использовать профильные дефолты reasoning; Custom: ручная настройка effort/summary">
                    Reasoning режим
                  </label>
                  <select id="reasoning-mode" data-field="reasoning-mode" title="Режим настройки reasoning">
                    <option value="auto">AUTO</option>
                    <option value="custom">CUSTOM</option>
                  </select>
                </div>
                <div class="popup__tool-row">
                  <label for="reasoning-effort" title="Интенсивность reasoning для Responses API (best-effort)">
                    Reasoning effort
                  </label>
                  <select id="reasoning-effort" data-field="reasoning-effort" title="Уровень effort">
                    <option value="minimal">minimal</option>
                    <option value="low">low</option>
                    <option value="medium">medium</option>
                    <option value="high">high</option>
                    <option value="max">max</option>
                  </select>
                </div>
                <div class="popup__tool-row">
                  <label for="reasoning-summary" title="Формат summary reasoning для Responses API (best-effort)">
                    Reasoning summary
                  </label>
                  <select id="reasoning-summary" data-field="reasoning-summary" title="Формат summary">
                    <option value="auto">auto</option>
                    <option value="none">none</option>
                    <option value="short">short</option>
                    <option value="detailed">detailed</option>
                  </select>
                </div>
                <div class="popup__tool-row">
                  <label for="agent-style-override" title="Оверрайд стилистики перевода поверх профиля">Стиль</label>
                  <select id="agent-style-override" data-field="agent-style-override" title="Если AUTO, стиль берётся из профиля">
                    <option value="auto">АВТО</option>
                    <option value="balanced">СБАЛАНСИР.</option>
                    <option value="literal">ДОСЛОВНЫЙ</option>
                    <option value="readable">ЧИТАЕМЫЙ</option>
                    <option value="technical">ТЕХНИЧЕСКИЙ</option>
                  </select>
                </div>
                <div class="popup__tool-row">
                  <label for="agent-batch-size" title="Размер батча для перевода. Пусто = автоматический выбор">Размер батча</label>
                  <input id="agent-batch-size" class="popup__input popup__input--narrow" type="number" min="1" placeholder="авто" data-field="agent-batch-size" title="Сколько блоков переводить в одном запросе">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-proofread-passes" title="Количество проходов вычитки после основного перевода">Проходы вычитки</label>
                  <input id="agent-proofread-passes" class="popup__input popup__input--narrow" type="number" min="0" placeholder="авто" data-field="agent-proofread-passes" title="0 = без вычитки, пусто = по профилю">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-parallelism" title="Уровень распараллеливания обработки блоков">Параллелизм</label>
                  <select id="agent-parallelism" data-field="agent-parallelism" title="AUTO подбирает уровень по сложности страницы">
                    <option value="auto">АВТО</option>
                    <option value="low">НИЗКИЙ</option>
                    <option value="mixed">СМЕШАННЫЙ</option>
                    <option value="high">ВЫСОКИЙ</option>
                  </select>
                </div>
                <div class="popup__tool-row">
                  <label for="agent-planner-temperature" title="Температура только для шага планирования агента">Температура планировщика</label>
                  <input id="agent-planner-temperature" class="popup__input popup__input--narrow" type="number" min="0" step="0.05" data-field="agent-planner-temperature" title="Ниже = стабильнее, выше = разнообразнее">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-planner-tokens" title="Максимум токенов, доступных шагу планирования">Лимит токенов планировщика</label>
                  <input id="agent-planner-tokens" class="popup__input popup__input--narrow" type="number" min="1" step="50" data-field="agent-planner-tokens" title="Ограничение длины ответа планировщика">
                </div>
              </div>
            </details>

            <details class="popup__details popup__details--nested" data-section="agent-optimization" open>
              <summary title="Интервалы аудита и параметры автосжатия контекста">Оптимизация и автосжатие</summary>
              <div class="popup__tool-grid popup__tool-grid--compact">
                <div class="popup__tool-row">
                  <label for="agent-audit-interval" title="Регулярный интервал аудита выполнения плана (мс)">Интервал аудита (мс)</label>
                  <input id="agent-audit-interval" class="popup__input popup__input--narrow" type="number" min="0" step="100" data-field="agent-audit-interval" title="Частота обычной проверки прогресса">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-mandatory-audit-interval" title="Минимальная частота обязательного аудита (мс)">Обязательный аудит (мс)</label>
                  <input id="agent-mandatory-audit-interval" class="popup__input popup__input--narrow" type="number" min="0" step="100" data-field="agent-mandatory-audit-interval" title="Минимальный интервал принудительного аудита">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-compression-threshold" title="Порог для запуска автосжатия контекста">Порог сжатия</label>
                  <input id="agent-compression-threshold" class="popup__input popup__input--narrow" type="number" min="0" step="1" data-field="agent-compression-threshold" title="Чем ниже значение, тем чаще будет автосжатие">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-context-limit" title="Лимит условного размера контекста перед сжатием">Лимит контекста (симв.)</label>
                  <input id="agent-context-limit" class="popup__input popup__input--narrow" type="number" min="1" step="500" data-field="agent-context-limit" title="Если контекст растёт выше лимита, запускается сжатие">
                </div>
                <div class="popup__tool-row">
                  <label for="compare-diff-threshold" title="Порог длины блока для compare mode. Если блок длиннее, на странице будет только outline-подсветка.">Порог compare diff (симв.)</label>
                  <input id="compare-diff-threshold" class="popup__input popup__input--narrow" type="number" min="500" step="100" data-field="compare-diff-threshold" title="Большие блоки выше порога не диффятся inline, смотрите debug">
                </div>
                <div class="popup__tool-row">
                  <label for="agent-compression-cooldown" title="Минимальная пауза между операциями сжатия (мс)">Пауза между сжатиями (мс)</label>
                  <input id="agent-compression-cooldown" class="popup__input popup__input--narrow" type="number" min="0" step="100" data-field="agent-compression-cooldown" title="Защита от слишком частого сжатия">
                </div>
              </div>
            </details>
          </details>
        </section>

        <section
          class="popup__tab-panel"
          role="tabpanel"
          id="popup-tab-models"
          data-tab-panel="models"
          aria-labelledby="popup-tab-button-models"
          hidden
        >
          <details class="popup__details popup__details--inline" data-section="credentials" open>
            <summary title="Безопасное подключение к API: Proxy (рекомендуется) или BYOK">Ключи и подключение</summary>
            <div class="popup__field popup__field--stack">
              <label class="popup__label popup__checkbox-row" title="Рекомендуемый режим: ключ OpenAI хранится на вашем сервере">
                <input type="radio" name="connection-mode" data-field="connection-mode-proxy" value="PROXY">
                <span>Через Proxy (рекомендуется)</span>
              </label>
              <label class="popup__label popup__checkbox-row" title="BYOK: используете свой OpenAI ключ на свой риск">
                <input type="radio" name="connection-mode" data-field="connection-mode-byok" value="BYOK">
                <span>Мой ключ OpenAI (BYOK)</span>
              </label>
            </div>

            <div class="popup__tool-grid popup__tool-grid--compact" data-section="proxy-config">
              <div class="popup__tool-row">
                <label for="proxy-url">Proxy URL</label>
                <input id="proxy-url" class="popup__input popup__input--narrow" type="text" data-field="proxy-url" placeholder="https://proxy.example.com" autocomplete="off">
              </div>
              <div class="popup__tool-row">
                <label for="proxy-token">Proxy token (optional)</label>
                <input id="proxy-token" class="popup__input popup__input--narrow" type="password" data-field="proxy-token" placeholder="token" autocomplete="off">
              </div>
              <div class="popup__tool-row">
                <label for="proxy-project-id">Project ID (optional)</label>
                <input id="proxy-project-id" class="popup__input popup__input--narrow" type="text" data-field="proxy-project-id" placeholder="project id">
              </div>
              <div class="popup__tool-row">
                <label for="proxy-header-name">Token header</label>
                <input id="proxy-header-name" class="popup__input popup__input--narrow" type="text" data-field="proxy-header-name" value="X-NT-Token" placeholder="X-NT-Token">
              </div>
              <label class="popup__label popup__checkbox-row" title="Сохранять token прокси постоянно (риск выше)">
                <input type="checkbox" data-field="proxy-token-persist">
                <span>Сохранить token постоянно</span>
              </label>
              <div class="popup__tool-row">
                <label>Proxy действия</label>
                <div class="popup__buttons-row">
                  <button class="popup__button" type="button" data-action="save-proxy-config">Сохранить Proxy</button>
                  <button class="popup__button" type="button" data-action="clear-proxy-config">Очистить Proxy</button>
                  <button class="popup__button" type="button" data-action="test-connection">Проверить</button>
                </div>
              </div>
            </div>

            <div class="popup__tool-grid popup__tool-grid--compact" data-section="byok-config">
              <div class="popup__tool-row">
                <label for="byok-key">OpenAI key</label>
                <input id="byok-key" class="popup__input popup__input--narrow" type="password" data-field="byok-key" placeholder="sk-..." autocomplete="off">
              </div>
              <label class="popup__label popup__checkbox-row" title="Постоянное хранение BYOK ключа повышает риск">
                <input type="checkbox" data-field="byok-persist">
                <span>Сохранить постоянно (НЕ рекомендовано)</span>
              </label>
              <label class="popup__label popup__checkbox-row" title="Подтвердите, что понимаете риск постоянного хранения ключа">
                <input type="checkbox" data-field="byok-persist-confirm">
                <span>Подтверждаю риск хранения ключа локально</span>
              </label>
              <div class="popup__tool-row">
                <label>BYOK действия</label>
                <div class="popup__buttons-row">
                  <button class="popup__button" type="button" data-action="save-byok-session">Сохранить на сессию</button>
                  <button class="popup__button" type="button" data-action="save-byok">Сохранить ключ</button>
                  <button class="popup__button" type="button" data-action="clear-byok">Очистить</button>
                </div>
              </div>
            </div>

            <div class="popup__label popup__label--warning" data-field="credentials-warning">Внимание: BYOK в браузере менее безопасен, чем Proxy режим.</div>
            <div class="popup__label popup__label--muted" data-field="credentials-status">Подключение: —</div>
            <div class="popup__label popup__label--muted" data-field="connection-test-status">Проверка: —</div>
          </details>

          <details class="popup__details popup__details--models" data-section="models-details" open>
            <summary title="Выберите список моделей, которые агенту разрешено использовать">
              Разрешённые модели
            </summary>
            <p class="popup__block-hint">
              Агент использует только модели из списка ниже. В каждой строке показана
              суммарная стоимость за 1M токенов.
            </p>
            <div class="popup__models" data-section="models"></div>
          </details>

          <details class="popup__details" data-section="agent-tools" open>
            <summary title="Режимы отдельных инструментов агента">Инструменты агента</summary>
            <div class="popup__tool-grid" data-section="agent-tools-grid"></div>
          </details>

          <details class="popup__details" data-section="agent-cache" open>
            <summary title="Настройки кэширования перевода и API">Кэширование</summary>
            <div class="popup__tool-grid popup__tool-grid--compact">
              <div class="popup__tool-row">
                <label for="prompt-cache-retention" title="Retention для prompt cache в Responses API (best-effort)">
                  Prompt cache retention
                </label>
                <select id="prompt-cache-retention" data-field="prompt-cache-retention" title="Режим retention для prompt cache">
                  <option value="auto">auto</option>
                  <option value="in_memory">in_memory</option>
                  <option value="extended">extended</option>
                  <option value="disabled">disabled</option>
                </select>
              </div>
              <div class="popup__tool-row">
                <label for="prompt-cache-key" title="Опциональный cache key для prompt cache (если провайдер поддерживает)">
                  Prompt cache key
                </label>
                <input id="prompt-cache-key" class="popup__input popup__input--narrow" type="text" data-field="prompt-cache-key" placeholder="опционально" title="Ключ prompt cache">
              </div>
            </div>
            <label class="popup__label popup__checkbox-row" title="При повторном открытии той же страницы агент сможет восстановить готовый перевод из кэша">
              <input type="checkbox" data-field="cache-enabled">
              <span>Запоминать переведённые страницы</span>
            </label>
            <label class="popup__label popup__checkbox-row" title="Повторные идентичные запросы к API могут браться из кэша, если это безопасно для текущего шага">
              <input type="checkbox" data-field="api-cache-enabled">
              <span>Кэшировать ответы API</span>
            </label>
            <label class="popup__label popup__checkbox-row" title="Сохранять перевод в долговременную память по URL + DOM hash и block hash">
              <input type="checkbox" data-field="memory-enabled">
              <span>Память перевода (страницы и блоки)</span>
            </label>
            <div class="popup__tool-grid popup__tool-grid--compact">
              <div class="popup__tool-row">
                <label title="Удаляет записи памяти только для текущей страницы и языка">
                  Очистка памяти страницы
                </label>
                <button class="popup__button" type="button" data-action="erase-page-memory" title="Стереть память только этой страницы">
                  Стереть страницу
                </button>
              </div>
              <div class="popup__tool-row">
                <label title="Полностью очищает IndexedDB память перевода">
                  Полная очистка памяти
                </label>
                <button class="popup__button" type="button" data-action="erase-all-memory" title="Стереть всю память перевода">
                  Стереть всё
                </button>
              </div>
            </div>
            <div class="popup__label popup__label--muted" data-field="memory-restore-stats">Память: —</div>
          </details>
        </section>
      </section>
    </main>

    <script src="../core/nt-namespace.js"></script>
    <script src="../core/time.js"></script>
    <script src="../core/html.js"></script>
    <script src="../core/retry-loop.js"></script>
    <script src="../core/chrome-local-store-base.js"></script>
    <script src="../core/event-types.js"></script>
    <script src="../core/agent-settings-policy.js"></script>
    <script src="../core/settings-store.js"></script>
    <script src="../core/message-envelope.js"></script>
    <script src="../core/ui-protocol.js"></script>
    <script src="../core/ui-port-client.js"></script>
    <script src="../core/runtime-paths.js"></script>
    <script src="../ai/capability-rank.js"></script>
    <script src="../ai/ai-common.js"></script>
    <script src="../ai/translation-agent.js"></script>
    <script src="./ui-module.js"></script>
    <script src="./popup.js"></script>
  </body>
</html>
